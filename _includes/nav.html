
{%- assign titled_pages = site.pages | where_exp:"item", "item.title != nil" -%}
{%- assign sorted_pages = titled_pages | sort:"nav_order" -%}

<nav id="sidebar" class="sidebar-wrapper">
  <div class="sidebar-content">
    <div class="sidebar-brand"><a href="{{ "/" | relative_url }}">{{ site.title | escape }}</a></div>
    <div class="sidebar-menu">
        <ul class="nav-list">
        {% for node in sorted_pages %}
          {%- if node.parent == nil -%}
          <li class="nav-list-item{% if page.url == node.url or page.parent == node.title %} active{% endif %}">
            <a href="{{ node.url }}"><span class="menu-text">{{ node.title }}</span></a>
            {%- if node.has_children -%}
            {%- assign children_list = sorted_pages | where: "parent", node.title -%}
            <ul class="nav-list ">
              {%- for child in children_list -%}
              <li class="nav-list-item {% if page.url == child.url or page.parent == child.title %} active{% endif %}">
                <a href="{{ child.url | absolute_url }}" class="nav-list-link{% if page.url == child.url %} active{% endif %}">{{ child.title }}</a>
              </li>
              {%- endfor -%}
            </ul>
            {%- endif -%}
          </li>
          {%- endif -%}
        {% endfor %}
        </ul>
    </div>
  </div>

  <div class="sidebar-footer">

  </div>
</nav>
