---
layout: default
title: Requests
nav_order: 4
---

# Requests

This section explains requests mechanisms into the Piko framework.

## Routing

A **request** corresponds to a route and have to be dispatched to a controller action.

A **route** is an internal identifier corresponding to a module, a controller and an action 
which is a controller's method suffixed by `Action`. 
A route is structured like this : `<moduleId>[/<subModuleId>]/<controllerId>/<actionId>`.

Example: The request URI `/hello` can correspond to the route `site/default/hello` which means that the application 
will dispatch the route to the method `helloAction` in the controller `DefaultController` in the module `site`.

## Configuration

Routes configuration consumed by [piko\Router](api/Router.md) consists only to an associative array where keys are 
URIs and values are their corresponding routes.

Example of configuration:

```php
<?php
return [
    // ...
    'components' => [
        'router' => [
            'class' => 'piko\Router',
            'routes' => [
                //...
                '/hello' => 'site/default/hello',
            ],
        ],
        // ...
    ]
];
```

## Request parameters

It is possible to retrieve parameters from URI. In the configuration, you can specify 
parameters in the URI prefixed by a colon character `:`. 
These parameters can be then retrieved in controller's action methods.

For instance, to retrieve an username from the URI:

```php
'routes' => [
    //...
    '/user/:username' => 'user/default/view',
]
```

The request `/user/:username` will be routed to the action `view` in the controller `default` from the `user` module .
The username can be then retrieved as argument of the `view` action method:

```php
namespace app\modules\user\controllers;

class DefaultController extends \piko\Controller
{
    public function viewAction(string $username)
    {
        return "Hello $username";
    }
}

```

With this example, the uri request `/user/john` will return *Hello john*.


## Dynamic routes

Internal routes can be dynamcally generated by request uri parameters :

```php
'routes' => [
    //...
    '/some/:action' => 'site/default/:action',
]
```

```php
namespace app\modules\site\controllers;

class DefaultController extends \piko\Controller
{
    //...

    public function timeAction()
    {
        return date('h:i:s');
    }
}
```

With this example, the uri request `/some/time` will return something like *12:32:42*.


## Retrieve URL from route

[piko\Router](api/Router.md) offers the ability to reverse a route to its URI:

```php

/** Configuration
'routes' => [
    //...
    '/user/:username' => 'user/default/view',
]
*/

use piko\Piko;

$router = Piko::get('router');

echo $router->getUrl('user/default/view', ['username' => 'johnny'];

// will output '/user/johnny'
```
